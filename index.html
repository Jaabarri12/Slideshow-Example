<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.60.0/phaser.js" 
    integrity="sha512-H05oT7BAjM9Ai1IaFX9zr61NtE2e1P0MkTz3AZXBnseaJSAOt2FGMFJ+vVGutaJxEGA1jxUiYsTBYQNE08/Erw==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>

        //First scene for audio to play by getting some form of input from user
        class Scene0 extends Phaser.Scene {
            constructor (){
                super({key: 'Scene0'});
            }

            create()
            {
                // Adds Rectangle and some text to start(mainly for requirments lol)
                this.add.rectangle(750, 325, 1000, 100, '0xff0000');
                this.add.text(400, 300, 'Press Space to Continue...',{fontSize: '50px', fill: '#000'});
                // Starts next scene when space is pressed
                this.input.keyboard.once('keydown-SPACE', () => {
                    this.scene.start('sceneA');
                });
            }
        }

        // First Actual Scene
        class SceneA extends Phaser.Scene {
            constructor () {
                super({key: 'sceneA'});
            }

            preload()
            {
                // Preloaded some images and audio
                this.load.image('quackStudio', 'assets/pics/duck.png');
                this.load.audio('quack', ['assets/audio/quack.mp3']);
            }

            create()
            {
                // Preload a lot of stuff for the next scene to avoid screen flicker
                this.load.audio('boom','assets/audio/boom.mp3');
                this.load.image('mountainL', 'assets/pics/mountainL.png');
                this.load.image('mountainM', 'assets/pics/mountainM.png');
                this.load.image('mountainR', 'assets/pics/mountainR.png');
                this.loadingDone = new Promise(resolve => this.load.on(Phaser.Loader.Events.COMPLETE, () => resolve()))
                this.load.start()

                // Adds the duck to this scene and positions him to the center of the screen
                const duck = this.add.image((window.innerWidth)/2,(window.innerHeight)/2,'quackStudio'); // Adds Duck image in game
                // Duck Height/Width
                duck.displayWidth = 1668/2;
                duck.displayHeight = 2388/2;

                // Audio that will play when the image loads
                let audio = this.sound.add('quack');
                audio.play();

                // Fading into the scene
                this.cameras.main.fadeIn(2000);
                
                // When space is pressed scene begins to fade out
                this.input.keyboard.once('keydown-SPACE', () => {
		            this.cameras.main.fadeOut(1000, 0, 0, 0)
	            });

                // Starts the next scene when the assets are all done loading(avoid screen flicker between scenes)
	            this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE, (cam, effect) => {
		            this.loadingDone.then(() => this.scene.start('sceneB'))
	            })
            }
        }

        // The second Scene of the intro
        class SceneB extends Phaser.Scene {
            constructor () {
                super({key: 'sceneB'});
            }
            
            preload() 
            {
            }

            create () {

                // Adding some of the art for the theme of the game/fading in
                this.cameras.main.fadeIn(1000,0,0,0);
                const mountainL = this.add.image((window.innerWidth)/2,(window.innerHeight)+500,'mountainL');
                const mountainM = this.add.image((window.innerWidth)/2, (window.innerHeight)+1500, 'mountainM');
                const mountainR = this.add.image((window.innerWidth)/2,(window.innerHeight)+1000, 'mountainR');

                // Plays the audio for the art coming in
                let audio = this.sound.add('boom');
                audio.play();

                // Some text to get the game going
                const text = this.add.text(20, 40, 'In a world full of rocks...',{fontSize: '32px', fill: '#000'});

                // Brings in the mountains from the bottom of the screen
                this.tweens.add({
                    targets: mountainL,
                    y: 500,
                    duration: 1000,
                    ease: 'cubic.in'
                });
                
                // Brings in the next mountain from the bottom of the screen
                this.tweens.add({
                    targets: mountainR,
                    y: 500,
                    duration: 1400,
                    ease: 'cubic.in'
                });

                // Brings in the next mountain from the bottom of the screen
                this.tweens.add({
                    targets: mountainM,
                    y: 500,
                    duration: 1750,
                    ease: 'cubic.in'
                });

                   // When space is pressed scene begins to fade out
                this.input.keyboard.once('keydown-SPACE', () => {
		            this.tweens.add({
                        targets: mountainL,
                        x: -1000,
                        duration: 1000 ,
                        ease: 'cubic.in'
                    });

                    this.tweens.add({
                        targets: mountainR,
                        x: 5000,
                        duration: 1200,
                        ease: 'cubic.in'
                    });

                    this.tweens.add({
                        targets: mountainM,
                        y: -3000,
                        duration: 1500,
                        ease: 'cubic.in'
                    });

                    this.tweens.add({
                        targets: text,
                        x: -1000,
                        duration: 1000,
                        ease: 'cubic.in'
                    });
                    
	            });

            }
        }
        
        class SceneC extends Phaser.scene {
          constructor () {
            super({key: 'sceneC'});
          }   
          preload(){

          } 
          create (){

          } 

        }
     
        // Some configs for the game window and scenes
        let game = new Phaser.Game({
            width: window.innerWidth,
            height: window.innerHeight,
            scene: [Scene0, SceneA, SceneB, SceneC],
            backgroundColor: 0xFFFFFF
        });
    </script>
</head>
<body>
    
</body>
</html>